---\n// Componente de herramientas de autocontrol para el Paso 4\n---\n\n<section class=\"mb-16\">\n  <div class=\"bg-gradient-to-r from-sky-600 to-cyan-600 text-white p-8 rounded-xl\">\n    <h2 class=\"text-2xl font-bold mb-6\">\ud83e\uddd8 Herramientas de Autocontrol</h2>\n    <p class=\"text-sky-100 mb-8\">\n      Pr\u00e1ctica estas t\u00e9cnicas ahora mismo. Son especialmente \u00fatiles en momentos de impulso:\n    </p>\n    \n    <!-- Technique Tabs -->\n    <div class=\"flex flex-wrap mb-8 border-b border-white/20\">\n      <button \n        class=\"tab-button px-6 py-3 font-semibold border-b-2 border-transparent hover:border-white/50 transition-colors active\"\n        data-tab=\"breathing\"\n      >\n        \ud83c\udf2c\ufe0f Respiraci\u00f3n Guiada\n      </button>\n      <button \n        class=\"tab-button px-6 py-3 font-semibold border-b-2 border-transparent hover:border-white/50 transition-colors\"\n        data-tab=\"stop-think\"\n      >\n        \u270b Stop-Think-Act\n      </button>\n      <button \n        class=\"tab-button px-6 py-3 font-semibold border-b-2 border-transparent hover:border-white/50 transition-colors\"\n        data-tab=\"distractors\"\n      >\n        \ud83c\udfaf Distractores de Urgencia\n      </button>\n      <button \n        class=\"tab-button px-6 py-3 font-semibold border-b-2 border-transparent hover:border-white/50 transition-colors\"\n        data-tab=\"plan\"\n      >\n        \ud83d\udcdd Plan de Acci\u00f3n\n      </button>\n    </div>\n\n    <!-- Breathing Exercise Tab -->\n    <div id=\"breathing-tab\" class=\"tab-content\">\n      <div class=\"bg-white/10 p-6 rounded-lg\">\n        <h3 class=\"text-xl font-bold mb-4\">\ud83c\udf2c\ufe0f Ejercicio de Respiraci\u00f3n 4-7-8</h3>\n        <p class=\"text-sky-100 mb-6\">\n          Esta t\u00e9cnica ayuda a reducir la ansiedad y los impulsos en 2-3 minutos:\n        </p>\n        \n        <div class=\"grid grid-cols-1 md:grid-cols-2 gap-6\">\n          <div class=\"space-y-4\">\n            <div class=\"text-center\">\n              <div id=\"breathing-circle\" class=\"w-32 h-32 mx-auto rounded-full border-4 border-white/30 flex items-center justify-center transition-all duration-1000\">\n                <span id=\"breathing-text\" class=\"text-2xl font-bold\">Preparado</span>\n              </div>\n              <div id=\"breathing-phase\" class=\"mt-4 text-lg font-semibold\">Presiona para comenzar</div>\n            </div>\n            \n            <div class=\"flex justify-center space-x-4\">\n              <button id=\"start-breathing\" class=\"px-6 py-3 bg-white/20 hover:bg-white/30 rounded-lg font-semibold transition-colors\">\n                \u25b6\ufe0f Comenzar\n              </button>\n              <button id=\"stop-breathing\" class=\"px-6 py-3 bg-red-500/70 hover:bg-red-500 rounded-lg font-semibold transition-colors hidden\">\n                \u23f9\ufe0f Parar\n              </button>\n            </div>\n          </div>\n          \n          <div class=\"space-y-4\">\n            <h4 class=\"font-bold\">C\u00f3mo funciona:</h4>\n            <div class=\"space-y-3 text-sm\">\n              <div class=\"flex items-start\">\n                <span class=\"w-6 h-6 bg-white/20 rounded-full flex items-center justify-center mr-3 mt-0.5 text-xs font-bold\">1</span>\n                <div>\n                  <div class=\"font-semibold\">Inhala por 4 segundos</div>\n                  <div class=\"text-sky-200\">Por la nariz, llenando el abdomen</div>\n                </div>\n              </div>\n              <div class=\"flex items-start\">\n                <span class=\"w-6 h-6 bg-white/20 rounded-full flex items-center justify-center mr-3 mt-0.5 text-xs font-bold\">2</span>\n                <div>\n                  <div class=\"font-semibold\">Mant\u00e9n por 7 segundos</div>\n                  <div class=\"text-sky-200\">Sin forzar, c\u00f3modamente</div>\n                </div>\n              </div>\n              <div class=\"flex items-start\">\n                <span class=\"w-6 h-6 bg-white/20 rounded-full flex items-center justify-center mr-3 mt-0.5 text-xs font-bold\">3</span>\n                <div>\n                  <div class=\"font-semibold\">Exhala por 8 segundos</div>\n                  <div class=\"text-sky-200\">Por la boca, completamente</div>\n                </div>\n              </div>\n            </div>\n            <div class=\"bg-white/10 p-3 rounded\">\n              <div class=\"text-sm\">\n                <strong>Ciclos completados:</strong> <span id=\"breathing-cycles\">0</span>/4\n              </div>\n            </div>\n          </div>\n        </div>\n      </div>\n    </div>\n\n    <!-- Stop-Think-Act Tab -->\n    <div id=\"stop-think-tab\" class=\"tab-content hidden\">\n      <div class=\"bg-white/10 p-6 rounded-lg\">\n        <h3 class=\"text-xl font-bold mb-4\">\u270b T\u00e9cnica Stop-Think-Act</h3>\n        <p class=\"text-sky-100 mb-6\">\n          Cuando sientes el impulso de jugar, sigue estos pasos:\n        </p>\n        \n        <div class=\"space-y-6\">\n          <div class=\"grid grid-cols-1 md:grid-cols-3 gap-6\">\n            <div class=\"bg-red-500/20 p-6 rounded-lg text-center\">\n              <div class=\"text-4xl mb-3\">\u270b</div>\n              <h4 class=\"text-xl font-bold mb-3\">STOP</h4>\n              <p class=\"text-sky-100\">Para lo que est\u00e1s haciendo. Reconoce el impulso.</p>\n              <button class=\"mt-4 px-4 py-2 bg-red-500 hover:bg-red-600 rounded-lg transition-colors\" onclick=\"activateStopPhase()\">\n                Activar STOP\n              </button>\n            </div>\n            \n            <div class=\"bg-yellow-500/20 p-6 rounded-lg text-center\">\n              <div class=\"text-4xl mb-3\">\ud83e\udd14</div>\n              <h4 class=\"text-xl font-bold mb-3\">THINK</h4>\n              <p class=\"text-sky-100\">Reflexiona sobre las consecuencias y alternativas.</p>\n            </div>\n            \n            <div class=\"bg-green-500/20 p-6 rounded-lg text-center\">\n              <div class=\"text-4xl mb-3\">\u2699\ufe0f</div>\n              <h4 class=\"text-xl font-bold mb-3\">ACT</h4>\n              <p class=\"text-sky-100\">Elige una acci\u00f3n saludable alternativa.</p>\n            </div>\n          </div>\n          \n          <div id=\"stop-think-interactive\" class=\"hidden bg-white/10 p-6 rounded-lg\">\n            <div id=\"stop-phase\" class=\"text-center\">\n              <h4 class=\"text-xl font-bold mb-4 text-red-300\">\u270b STOP - Toma un momento</h4>\n              <p class=\"mb-4\">Reconoce que est\u00e1s sintiendo un impulso. Esto es normal.</p>\n              <div class=\"text-6xl mb-4 animate-pulse\">\u270b</div>\n              <button class=\"px-6 py-3 bg-yellow-500 hover:bg-yellow-600 text-gray-900 font-bold rounded-lg\" onclick=\"activateThinkPhase()\">\n                Continuar a THINK \u2192\n              </button>\n            </div>\n            \n            <div id=\"think-phase\" class=\"hidden\">\n              <h4 class=\"text-xl font-bold mb-4 text-yellow-300\">\ud83e\udd14 THINK - Reflexiona</h4>\n              <div class=\"grid grid-cols-1 md:grid-cols-2 gap-6\">\n                <div>\n                  <h5 class=\"font-bold mb-2 text-red-300\">Si juego ahora...</h5>\n                  <ul class=\"text-sm space-y-1 text-sky-100\">\n                    <li>\u2022 Probablemente perder\u00e9 dinero</li>\n                    <li>\u2022 Me sentir\u00e9 culpable despu\u00e9s</li>\n                    <li>\u2022 No resolver\u00e9 mis problemas reales</li>\n                    <li>\u2022 Reforzar\u00e9 el h\u00e1bito</li>\n                  </ul>\n                </div>\n                <div>\n                  <h5 class=\"font-bold mb-2 text-green-300\">Si no juego...</h5>\n                  <ul class=\"text-sm space-y-1 text-sky-100\">\n                    <li>\u2022 Mantendr\u00e9 mi dinero</li>\n                    <li>\u2022 Me sentir\u00e9 orgulloso/a</li>\n                    <li>\u2022 Podr\u00e9 hacer algo constructivo</li>\n                    <li>\u2022 Fortalecer\u00e9 mi autocontrol</li>\n                  </ul>\n                </div>\n              </div>\n              <div class=\"text-center mt-6\">\n                <button class=\"px-6 py-3 bg-green-500 hover:bg-green-600 text-white font-bold rounded-lg\" onclick=\"activateActPhase()\">\n                  Continuar a ACT \u2192\n                </button>\n              </div>\n            </div>\n            \n            <div id=\"act-phase\" class=\"hidden\">\n              <h4 class=\"text-xl font-bold mb-4 text-green-300\">\u2699\ufe0f ACT - Elige una acci\u00f3n</h4>\n              <p class=\"mb-4\">Selecciona una actividad alternativa:</p>\n              <div class=\"grid grid-cols-2 md:grid-cols-4 gap-4\">\n                <button class=\"p-4 bg-white/10 hover:bg-white/20 rounded-lg transition-colors\" onclick=\"selectAction('Llamar a un amigo')\">\n                  <div class=\"text-2xl mb-2\">\ud83d\udcde</div>\n                  <div class=\"text-sm\">Llamar a un amigo</div>\n                </button>\n                <button class=\"p-4 bg-white/10 hover:bg-white/20 rounded-lg transition-colors\" onclick=\"selectAction('Salir a caminar')\">\n                  <div class=\"text-2xl mb-2\">\ud83d\udeb6</div>\n                  <div class=\"text-sm\">Salir a caminar</div>\n                </button>\n                <button class=\"p-4 bg-white/10 hover:bg-white/20 rounded-lg transition-colors\" onclick=\"selectAction('Hacer ejercicio')\">\n                  <div class=\"text-2xl mb-2\">\ud83c\udfcb\ufe0f</div>\n                  <div class=\"text-sm\">Hacer ejercicio</div>\n                </button>\n                <button class=\"p-4 bg-white/10 hover:bg-white/20 rounded-lg transition-colors\" onclick=\"selectAction('Leer un libro')\">\n                  <div class=\"text-2xl mb-2\">\ud83d\udcda</div>\n                  <div class=\"text-sm\">Leer un libro</div>\n                </button>\n              </div>\n              <div id=\"action-selected\" class=\"hidden mt-6 p-4 bg-green-500/20 rounded-lg text-center\">\n                <h5 class=\"font-bold mb-2\">¡Excelente elecci\u00f3n!</h5>\n                <p id=\"selected-action\"></p>\n                <button class=\"mt-4 px-6 py-3 bg-white/20 hover:bg-white/30 rounded-lg\" onclick=\"resetStopThink()\">\n                  Reiniciar ejercicio\n                </button>\n              </div>\n            </div>\n          </div>\n        </div>\n      </div>\n    </div>\n\n    <!-- Distractor Tab -->\n    <div id=\"distractors-tab\" class=\"tab-content hidden\">\n      <div class=\"bg-white/10 p-6 rounded-lg\">\n        <h3 class=\"text-xl font-bold mb-4\">\ud83c\udfaf Distractores de Urgencia</h3>\n        <p class=\"text-sky-100 mb-6\">\n          Lista de actividades r\u00e1pidas para cuando sientes un impulso fuerte:\n        </p>\n        \n        <div class=\"grid grid-cols-1 md:grid-cols-2 gap-6\">\n          <div>\n            <h4 class=\"font-bold mb-4\">\u26a1 Actividades de 2 minutos</h4>\n            <div class=\"space-y-3\">\n              <div class=\"flex items-center p-3 bg-white/10 rounded-lg hover:bg-white/20 transition-colors cursor-pointer\" onclick=\"startDistractor('Contar hacia atr\u00e1s desde 100 de 7 en 7', 120)\">\n                <span class=\"text-2xl mr-3\">\ud83d\udd22</span>\n                <div>\n                  <div class=\"font-semibold\">Contar hacia atr\u00e1s</div>\n                  <div class=\"text-sm text-sky-200\">Desde 100, de 7 en 7</div>\n                </div>\n              </div>\n              <div class=\"flex items-center p-3 bg-white/10 rounded-lg hover:bg-white/20 transition-colors cursor-pointer\" onclick=\"startDistractor('Nombrar 5 cosas que ves, 4 que escuchas, 3 que tocas', 120)\">\n                <span class=\"text-2xl mr-3\">\ud83d\udc41\ufe0f</span>\n                <div>\n                  <div class=\"font-semibold\">T\u00e9cnica 5-4-3</div>\n                  <div class=\"text-sm text-sky-200\">Conecta con tus sentidos</div>\n                </div>\n              </div>\n              <div class=\"flex items-center p-3 bg-white/10 rounded-lg hover:bg-white/20 transition-colors cursor-pointer\" onclick=\"startDistractor('Tensar y relajar cada m\u00fasculo por 5 segundos', 120)\">\n                <span class=\"text-2xl mr-3\">\ud83d\udcaa</span>\n                <div>\n                  <div class=\"font-semibold\">Relajaci\u00f3n muscular</div>\n                  <div class=\"text-sm text-sky-200\">Tensa y relaja</div>\n                </div>\n              </div>\n            </div>\n          </div>\n          \n          <div>\n            <h4 class=\"font-bold mb-4\">\ud83d\udd50 Actividades de 5-10 minutos</h4>\n            <div class=\"space-y-3\">\n              <div class=\"flex items-center p-3 bg-white/10 rounded-lg hover:bg-white/20 transition-colors cursor-pointer\" onclick=\"startDistractor('Escribir c\u00f3mo te sientes sin censura', 300)\">\n                <span class=\"text-2xl mr-3\">\u270d\ufe0f</span>\n                <div>\n                  <div class=\"font-semibold\">Escribir emociones</div>\n                  <div class=\"text-sm text-sky-200\">Descarga mental</div>\n                </div>\n              </div>\n              <div class=\"flex items-center p-3 bg-white/10 rounded-lg hover:bg-white/20 transition-colors cursor-pointer\" onclick=\"startDistractor('Llamar a alguien que te importe', 600)\">\n                <span class=\"text-2xl mr-3\">\ud83d\udcde</span>\n                <div>\n                  <div class=\"font-semibold\">Conectar socialmente</div>\n                  <div class=\"text-sm text-sky-200\">Busca apoyo</div>\n                </div>\n              </div>\n              <div class=\"flex items-center p-3 bg-white/10 rounded-lg hover:bg-white/20 transition-colors cursor-pointer\" onclick=\"startDistractor('Hacer algo creativo con las manos', 600)\">\n                <span class=\"text-2xl mr-3\">\ud83c\udfa8</span>\n                <div>\n                  <div class=\"font-semibold\">Actividad creativa</div>\n                  <div class=\"text-sm text-sky-200\">Dibujar, construir, crear</div>\n                </div>\n              </div>\n            </div>\n          </div>\n        </div>\n        \n        <div id=\"distractor-timer\" class=\"hidden mt-6 p-6 bg-white/20 rounded-lg text-center\">\n          <h4 class=\"text-xl font-bold mb-4\">Actividad en curso</h4>\n          <div id=\"distractor-activity\" class=\"text-lg mb-4\"></div>\n          <div id=\"distractor-countdown\" class=\"text-4xl font-bold mb-4\"></div>\n          <button id=\"distractor-complete\" class=\"px-6 py-3 bg-green-500 hover:bg-green-600 rounded-lg font-semibold\">\n            \u2705 Completado\n          </button>\n        </div>\n      </div>\n    </div>\n\n    <!-- Action Plan Tab -->\n    <div id=\"plan-tab\" class=\"tab-content hidden\">\n      <div class=\"bg-white/10 p-6 rounded-lg\">\n        <h3 class=\"text-xl font-bold mb-4\">\ud83d\udcdd Tu Plan Personal de Autocontrol</h3>\n        <p class=\"text-sky-100 mb-6\">\n          Crea un plan personalizado que puedas usar en situaciones reales:\n        </p>\n        \n        <div class=\"space-y-6\">\n          <div>\n            <label class=\"block font-semibold mb-2\">1. \u00bfCu\u00e1les son tus principales triggers (desencadenantes)?</label>\n            <textarea \n              id=\"triggers-input\" \n              class=\"w-full p-3 bg-white/20 border border-white/30 rounded-lg text-white placeholder-white/70 resize-none\" \n              rows=\"3\" \n              placeholder=\"Ej: estr\u00e9s en el trabajo, aburrimiento, problemas de dinero...\"\n            ></textarea>\n          </div>\n          \n          <div>\n            <label class=\"block font-semibold mb-2\">2. \u00bfQu\u00e9 t\u00e9cnica te funcion\u00f3 mejor hoy?</label>\n            <select id=\"best-technique\" class=\"w-full p-3 bg-white/20 border border-white/30 rounded-lg text-white\">\n              <option value=\"\">Selecciona...</option>\n              <option value=\"breathing\">Respiraci\u00f3n 4-7-8</option>\n              <option value=\"stop-think-act\">Stop-Think-Act</option>\n              <option value=\"distractors\">Distractores de urgencia</option>\n              <option value=\"combination\">Combinaci\u00f3n de t\u00e9cnicas</option>\n            </select>\n          </div>\n          \n          <div>\n            <label class=\"block font-semibold mb-2\">3. Lista 3 actividades alternativas que disfrutas:</label>\n            <div class=\"space-y-2\">\n              <input type=\"text\" id=\"activity-1\" class=\"w-full p-3 bg-white/20 border border-white/30 rounded-lg text-white placeholder-white/70\" placeholder=\"Actividad 1\">\n              <input type=\"text\" id=\"activity-2\" class=\"w-full p-3 bg-white/20 border border-white/30 rounded-lg text-white placeholder-white/70\" placeholder=\"Actividad 2\">\n              <input type=\"text\" id=\"activity-3\" class=\"w-full p-3 bg-white/20 border border-white/30 rounded-lg text-white placeholder-white/70\" placeholder=\"Actividad 3\">\n            </div>\n          </div>\n          \n          <div>\n            <label class=\"block font-semibold mb-2\">4. Persona de confianza a quien puedes contactar:</label>\n            <input type=\"text\" id=\"support-person\" class=\"w-full p-3 bg-white/20 border border-white/30 rounded-lg text-white placeholder-white/70\" placeholder=\"Nombre y tel\u00e9fono\">\n          </div>\n          \n          <div class=\"flex justify-center\">\n            <button id=\"save-plan\" class=\"px-8 py-3 bg-green-500 hover:bg-green-600 text-white font-bold rounded-lg transition-colors\">\n              \ud83d\udcbe Guardar Mi Plan\n            </button>\n          </div>\n          \n          <div id=\"plan-saved\" class=\"hidden p-4 bg-green-500/20 rounded-lg text-center\">\n            <h4 class=\"font-bold mb-2\">\u2705 Plan guardado exitosamente</h4>\n            <p class=\"text-sky-100 mb-4\">Tu plan est\u00e1 guardado localmente en tu dispositivo</p>\n            <button id=\"download-plan\" class=\"px-6 py-3 bg-white/20 hover:bg-white/30 rounded-lg transition-colors\">\n              \ud83d\udcce Descargar como PDF\n            </button>\n          </div>\n        </div>\n      </div>\n    </div>\n  </div>\n</section>\n\n<script>\n// Self-Control Tools functionality\ndocument.addEventListener('DOMContentLoaded', () => {\n  // Tab switching\n  const tabButtons = document.querySelectorAll('.tab-button');\n  const tabContents = document.querySelectorAll('.tab-content');\n  \n  tabButtons.forEach(button => {\n    button.addEventListener('click', () => {\n      const tabId = button.getAttribute('data-tab');\n      \n      // Update button states\n      tabButtons.forEach(b => b.classList.remove('active', 'border-white'));\n      button.classList.add('active', 'border-white');\n      \n      // Update content visibility\n      tabContents.forEach(content => content.classList.add('hidden'));\n      document.getElementById(tabId + '-tab').classList.remove('hidden');\n    });\n  });\n  \n  // Breathing exercise\n  let breathingTimer;\n  let breathingCycle = 0;\n  let totalCycles = 0;\n  \n  const startBreathing = document.getElementById('start-breathing');\n  const stopBreathing = document.getElementById('stop-breathing');\n  const breathingCircle = document.getElementById('breathing-circle');\n  const breathingText = document.getElementById('breathing-text');\n  const breathingPhase = document.getElementById('breathing-phase');\n  const breathingCycles = document.getElementById('breathing-cycles');\n  \n  function updateBreathingUI(phase, seconds, isActive = false) {\n    breathingText.textContent = seconds;\n    breathingPhase.textContent = phase;\n    \n    if (isActive) {\n      breathingCircle.classList.add('scale-110', 'border-yellow-400');\n    } else {\n      breathingCircle.classList.remove('scale-110', 'border-yellow-400');\n    }\n  }\n  \n  function breathingSequence() {\n    let phase = 0; // 0: inhale, 1: hold, 2: exhale\n    let seconds = phase === 0 ? 4 : phase === 1 ? 7 : 8;\n    let currentSecond = seconds;\n    \n    const phases = ['Inhala profundamente', 'Mant\u00e9n la respiraci\u00f3n', 'Exhala lentamente'];\n    \n    updateBreathingUI(phases[phase], currentSecond, phase === 0 || phase === 2);\n    \n    breathingTimer = setInterval(() => {\n      currentSecond--;\n      \n      if (currentSecond > 0) {\n        updateBreathingUI(phases[phase], currentSecond, phase === 0 || phase === 2);\n      } else {\n        phase++;\n        \n        if (phase < 3) {\n          seconds = phase === 0 ? 4 : phase === 1 ? 7 : 8;\n          currentSecond = seconds;\n          updateBreathingUI(phases[phase], currentSecond, phase === 0 || phase === 2);\n        } else {\n          // Cycle complete\n          totalCycles++;\n          breathingCycles.textContent = totalCycles;\n          \n          if (totalCycles < 4) {\n            // Start next cycle\n            setTimeout(() => {\n              if (breathingTimer) breathingSequence();\n            }, 1000);\n          } else {\n            // Exercise complete\n            updateBreathingUI('¡Ejercicio completado!', '✅', false);\n            stopBreathingExercise();\n            alert('\u00a1Felicitaciones! Has completado el ejercicio de respiraci\u00f3n. \u00bfC\u00f3mo te sientes?');\n          }\n        }\n      }\n    }, 1000);\n  }\n  \n  function stopBreathingExercise() {\n    if (breathingTimer) {\n      clearInterval(breathingTimer);\n      breathingTimer = null;\n    }\n    startBreathing.classList.remove('hidden');\n    stopBreathing.classList.add('hidden');\n    updateBreathingUI('Preparado', 'Presiona para comenzar', false);\n  }\n  \n  startBreathing.addEventListener('click', () => {\n    totalCycles = 0;\n    breathingCycles.textContent = '0';\n    startBreathing.classList.add('hidden');\n    stopBreathing.classList.remove('hidden');\n    breathingSequence();\n  });\n  \n  stopBreathing.addEventListener('click', stopBreathingExercise);\n  \n  // Distractor timer\n  let distractorTimer;\n  \n  window.startDistractor = function(activity, duration) {\n    document.getElementById('distractor-activity').textContent = activity;\n    document.getElementById('distractor-timer').classList.remove('hidden');\n    \n    let remaining = duration;\n    \n    function updateTimer() {\n      const minutes = Math.floor(remaining / 60);\n      const seconds = remaining % 60;\n      document.getElementById('distractor-countdown').textContent = \n        `${minutes}:${seconds.toString().padStart(2, '0')}`;\n      \n      if (remaining > 0) {\n        remaining--;\n      } else {\n        clearInterval(distractorTimer);\n        document.getElementById('distractor-countdown').textContent = '\u00a1Tiempo!';\n      }\n    }\n    \n    updateTimer();\n    distractorTimer = setInterval(updateTimer, 1000);\n  };\n  \n  document.getElementById('distractor-complete').addEventListener('click', () => {\n    if (distractorTimer) clearInterval(distractorTimer);\n    document.getElementById('distractor-timer').classList.add('hidden');\n    alert('\u00a1Excelente! Has usado una t\u00e9cnica de autocontrol efectiva.');\n  });\n  \n  // Stop-Think-Act functionality\n  window.activateStopPhase = function() {\n    document.getElementById('stop-think-interactive').classList.remove('hidden');\n    document.getElementById('stop-phase').classList.remove('hidden');\n    document.getElementById('think-phase').classList.add('hidden');\n    document.getElementById('act-phase').classList.add('hidden');\n  };\n  \n  window.activateThinkPhase = function() {\n    document.getElementById('stop-phase').classList.add('hidden');\n    document.getElementById('think-phase').classList.remove('hidden');\n  };\n  \n  window.activateActPhase = function() {\n    document.getElementById('think-phase').classList.add('hidden');\n    document.getElementById('act-phase').classList.remove('hidden');\n  };\n  \n  window.selectAction = function(action) {\n    document.getElementById('selected-action').textContent = `Has elegido: ${action}`;\n    document.getElementById('action-selected').classList.remove('hidden');\n  };\n  \n  window.resetStopThink = function() {\n    document.getElementById('stop-think-interactive').classList.add('hidden');\n    document.getElementById('action-selected').classList.add('hidden');\n  };\n  \n  // Action plan saving\n  document.getElementById('save-plan').addEventListener('click', () => {\n    const plan = {\n      triggers: document.getElementById('triggers-input').value,\n      bestTechnique: document.getElementById('best-technique').value,\n      activities: [\n        document.getElementById('activity-1').value,\n        document.getElementById('activity-2').value,\n        document.getElementById('activity-3').value\n      ],\n      supportPerson: document.getElementById('support-person').value,\n      createdAt: new Date().toISOString()\n    };\n    \n    // Save to localStorage\n    localStorage.setItem('self-control-plan', JSON.stringify(plan));\n    \n    // Save to progress manager\n    if (window.progressManager) {\n      window.progressManager.savePersonalPlan('paso-4', plan);\n    }\n    \n    document.getElementById('plan-saved').classList.remove('hidden');\n  });\n  \n  // Load existing plan\n  const existingPlan = localStorage.getItem('self-control-plan');\n  if (existingPlan) {\n    const plan = JSON.parse(existingPlan);\n    document.getElementById('triggers-input').value = plan.triggers || '';\n    document.getElementById('best-technique').value = plan.bestTechnique || '';\n    document.getElementById('activity-1').value = plan.activities[0] || '';\n    document.getElementById('activity-2').value = plan.activities[1] || '';\n    document.getElementById('activity-3').value = plan.activities[2] || '';\n    document.getElementById('support-person').value = plan.supportPerson || '';\n  }\n});\n</script>\n\n<style>\n.tab-button.active {\n  border-bottom-color: white;\n}\n\n#breathing-circle {\n  transition: all 1s ease-in-out;\n}\n\n.tab-content {\n  animation: fadeIn 0.3s ease-in-out;\n}\n\n@keyframes fadeIn {\n  from { opacity: 0; transform: translateY(10px); }\n  to { opacity: 1; transform: translateY(0); }\n}\n</style>
